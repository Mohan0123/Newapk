<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="frame-ancestors 'self';">
    <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
    <meta name="referrer" content="no-referrer">
    <title>Ranginx â€“ Watch 18+ Web Series & Movies Online</title>
    
    <meta name="description" content="Watch latest HD web series and movies online. Free streaming on Ranginx.">
    <meta name="robots" content="index, follow">
    <meta name="rating" content="RTA-5042-1996-1400-1577-RTA" />
    <meta name="adult" content="true" />

    <meta property="og:site_name" content="Ranginx">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Ranginx - Premium Streaming">
    <meta property="og:image" content="https://ranginx.fun/og-image.jpg">
    <meta property="og:url" content="https://ranginx.fun/">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: { brand: '#e50914', dark: { bg: '#0a0a0a', card: '#121212', border: '#262626' } },
                    fontFamily: { sans: ['Outfit', 'sans-serif'] },
                    animation: { 'fade': 'fadeIn 0.5s ease-out' },
                    keyframes: { fadeIn: { '0%': { opacity: '0', transform: 'translateY(10px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } } }
                }
            }
        }
    </script>

    <style>
        body { background-color: #0a0a0a; color: #e5e5e5; overflow-x: hidden; font-family: 'Outfit', sans-serif; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0a0a0a; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        
        .glass-nav { background: rgba(10, 10, 10, 0.9); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(255, 255, 255, 0.05); }
        .ad-slot { display: none; width: 100%; margin: 30px 0; justify-content: center; overflow: hidden; }
        .ad-slot.active { display: flex; border: 1px solid #262626; background: #0f0f0f; min-height: 90px; }
        
        .ep-btn { 
            display: flex; align-items: center; justify-content: center; height: 40px; border-radius: 6px; 
            border: 1px solid #262626; background: #141414; color: #aaa; font-size: 14px; font-weight: 500; 
            transition: all 0.2s ease; text-decoration: none; cursor: pointer;
        }
        .ep-btn:hover { background: #222; color: white; border-color: #444; }
        .ep-btn.active { background: #e50914; color: white; border-color: #e50914; pointer-events: none; }
        
        .footer-link { cursor: pointer; color: #888; font-size: 14px; margin-bottom: 8px; display: block; transition: 0.2s; }
        .footer-link:hover { color: #e50914; }
        
        /* Legal Content Styling */
        .legal-content h2 { font-size: 1.5rem; font-weight: 700; color: white; margin-bottom: 1rem; margin-top: 1.5rem; border-bottom: 1px solid #333; padding-bottom: 0.5rem; }
        .legal-content h3 { font-size: 1.2rem; font-weight: 600; color: #e5e5e5; margin-bottom: 0.5rem; margin-top: 1rem; }
        .legal-content p { margin-bottom: 1rem; color: #9ca3af; line-height: 1.6; }
        .legal-content ul { list-style: disc; margin-left: 1.5rem; color: #9ca3af; margin-bottom: 1rem; }
        
        .cinema-mode { position: fixed; inset: 0; background: black; z-index: 100; padding: 0; display: flex; align-items: center; justify-content: center; }
        .cinema-mode nav, .cinema-mode footer, .cinema-mode .sidebar-recs, .cinema-mode .details-section, .cinema-mode #player-ad-top, .cinema-mode #player-ad-bot { display: none !important; }
        .cinema-mode .player-container { width: 100% !important; max-width: 100% !important; height: 100vh; }
        .cinema-mode #player-wrapper { height: 100vh !important; }
    </style>
</head>
<body>

<nav class="fixed top-0 w-full h-16 glass-nav z-[60] flex items-center justify-between px-4 lg:px-8 transition-all duration-300">
    <div class="flex items-center gap-6">
        <button id="menu-btn" class="p-2 text-gray-300 hover:text-white transition"><i data-lucide="menu" class="w-6 h-6"></i></button>
        <a href="/" onclick="route(event)" class="text-2xl font-bold tracking-tighter text-white flex items-center gap-1">
            <span class="text-brand">Rang</span>inx
        </a>
    </div>

    <div class="hidden md:flex flex-grow max-w-md mx-8 relative">
        <input type="text" id="desktop-search" placeholder="Search movies, series..." class="w-full bg-[#141414] border border-[#262626] pl-10 pr-4 py-2.5 rounded-full outline-none text-sm text-white focus:border-brand transition shadow-inner">
        <i data-lucide="search" class="w-4 h-4 text-gray-500 absolute left-3.5 top-3"></i>
    </div>
    <button class="md:hidden p-2 text-white" onclick="document.getElementById('mobile-search').classList.toggle('hidden')"><i data-lucide="search" class="w-6 h-6"></i></button>
</nav>

<div id="mobile-search" class="fixed top-16 left-0 w-full bg-[#0a0a0a] p-4 hidden z-40 border-b border-[#262626] glass-nav">
    <form class="flex relative" onsubmit="event.preventDefault(); handleSearch(this.querySelector('input').value)">
        <input type="text" placeholder="Search..." class="w-full bg-[#141414] border border-[#262626] pl-10 pr-4 py-3 rounded-lg outline-none text-white focus:border-brand">
        <i data-lucide="search" class="w-5 h-5 text-gray-500 absolute left-3 top-3.5"></i>
    </form>
</div>

<aside id="sidebar" class="fixed top-16 left-0 h-full w-72 bg-[#0a0a0a] transform -translate-x-full transition-transform duration-300 z-[55] border-r border-[#262626] p-4 flex flex-col">
    <div class="space-y-1">
        <a href="/" onclick="route(event)" class="flex items-center gap-4 px-4 py-3.5 hover:bg-[#141414] rounded-lg text-gray-400 hover:text-brand transition font-medium"><i data-lucide="home" class="w-5 h-5"></i> Home</a>
        <a href="/movies" onclick="route(event)" class="flex items-center gap-4 px-4 py-3.5 hover:bg-[#141414] rounded-lg text-gray-400 hover:text-white transition font-medium"><i data-lucide="film" class="w-5 h-5"></i> Movies</a>
        <a href="/series" onclick="route(event)" class="flex items-center gap-4 px-4 py-3.5 hover:bg-[#141414] rounded-lg text-gray-400 hover:text-white transition font-medium"><i data-lucide="tv" class="w-5 h-5"></i> Web Series</a>
    </div>
    <div class="h-px bg-[#262626] my-4 mx-2"></div>
    <div class="space-y-1">
        <button onclick="openModal('dmca')" class="w-full flex items-center gap-4 px-4 py-3 hover:bg-[#141414] rounded-lg text-gray-400 hover:text-white text-left text-sm"><i data-lucide="shield-alert" class="w-4 h-4"></i> DMCA</button>
        <button onclick="openModal('privacy')" class="w-full flex items-center gap-4 px-4 py-3 hover:bg-[#141414] rounded-lg text-gray-400 hover:text-white text-left text-sm"><i data-lucide="lock" class="w-4 h-4"></i> Privacy</button>
        <button onclick="openModal('terms')" class="w-full flex items-center gap-4 px-4 py-3 hover:bg-[#141414] rounded-lg text-gray-400 hover:text-white text-left text-sm"><i data-lucide="file-text" class="w-4 h-4"></i> Terms</button>
    </div>
</aside>
<div id="overlay" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-[50] hidden transition-opacity" onclick="toggleSidebar()"></div>

<div id="legal-modal" class="fixed inset-0 z-[100] bg-black/80 hidden items-center justify-center backdrop-blur-md p-4">
    <div class="bg-[#141414] w-full max-w-2xl rounded-2xl border border-[#262626] shadow-2xl flex flex-col max-h-[90vh] overflow-hidden transform transition-all scale-95 animate-fade">
        <div class="flex justify-between items-center p-5 border-b border-[#262626]">
            <h2 id="modal-title" class="text-xl font-bold text-white tracking-tight">Legal</h2>
            <button onclick="closeModal()" class="p-2 hover:bg-[#222] rounded-full transition"><i data-lucide="x" class="w-5 h-5 text-gray-400"></i></button>
        </div>
        <div id="modal-body" class="p-8 overflow-y-auto text-sm text-gray-400 leading-relaxed legal-content"></div>
    </div>
</div>

<main id="app" class="pt-16 min-h-screen"></main>

<script>
    // --- ðŸ”´ ADS CONFIGURATION ---
    const ADS = {
        header: ``,       // Ad below Navbar
        footer: ``,       // Ad above Footer
        playerTop: ``,    // Ad above Player
        playerBottom: ``, // Ad below Player
        grid: ``          // Grid Ad (Every 5 videos)
    };

    let allContent = [];
    const STATE = { player: null, hls: null, filter: 'all' };

    // --- ANALYTICS (Safe Mode) ---
    function isAnalyticsSafe() { return true; }
    function incrementViewSafe() {}
    function trackPageActivity() {}

    // --- AUTO STORYLINE GENERATOR ---
    function getStoryline(item) {
        if(item.description && item.description.trim() !== "" && item.description.length > 20) {
            return item.description;
        }
        // Generate Automatic Description
        const type = item.type === 'series' ? 'Web Series' : 'Movie';
        return `Watch <strong>${item.name}</strong> ${type} online in Full HD on Ranginx. This is the latest ${type} featuring intense drama and romance. Stream all episodes of ${item.name} for free without registration. Enjoy seamless high-quality playback only on Ranginx.`;
    }

    // --- SEO UPDATER ---
    function updateSEO(meta) {
        document.title = meta.title;
        let descMeta = document.querySelector('meta[name="description"]');
        if (!descMeta) { descMeta = document.createElement('meta'); descMeta.setAttribute('name', 'description'); document.head.appendChild(descMeta); }
        descMeta.setAttribute("content", meta.desc);
        
        let canonicalUrl = meta.url || `https://ranginx.fun${window.location.pathname}`;
        if (canonicalUrl.endsWith('/') && canonicalUrl !== 'https://ranginx.fun/') canonicalUrl = canonicalUrl.slice(0, -1);
        let linkCanon = document.querySelector('link[rel="canonical"]');
        if(!linkCanon) { linkCanon = document.createElement('link'); linkCanon.setAttribute('rel', 'canonical'); document.head.appendChild(linkCanon); }
        linkCanon.setAttribute("href", canonicalUrl);
    }

    window.route = (event) => { event.preventDefault(); window.history.pushState({}, "", event.currentTarget.href); handleLocation(); };
    window.onpopstate = handleLocation;

    // --- MAIN ROUTER ---
    async function handleLocation() {
        const path = window.location.pathname;
        const parts = path.split('/').filter(p => p);
        
        document.getElementById('sidebar').classList.add('-translate-x-full');
        document.getElementById('overlay').classList.add('hidden');
        window.scrollTo({ top: 0, behavior: 'smooth' });
        destroyPlayer();

        if (window.location.pathname.length > 1 && window.location.pathname.endsWith('/')) {
            window.history.replaceState({}, "", window.location.pathname.slice(0, -1));
        }

        if (parts.length === 0 || path === '/index.html' || path === '/') { renderHome(); return; }
        if (parts[0] === 'movies') { renderHome('movie'); return; }
        if (parts[0] === 'series') { renderHome('series'); return; }

        const slug = decodeURIComponent(parts[0]);
        const item = allContent.find(i => (i.slug || createSlug(i.name)).toLowerCase() === slug.toLowerCase());

        if (!item) { render404(); return; }

        const subPage = parts[1]; 
        if (item.type === 'series') {
            if (parts.length === 1) renderSeriesLanding(item);
            else if (parts.length === 2 && parts[1].startsWith('episode-')) {
                const epNum = parseInt(parts[1].replace('episode-', ''));
                if (Number.isInteger(epNum) && epNum > 0) renderPlayer(item, epNum);
                else { window.history.replaceState({}, "", `/${slug}`); renderSeriesLanding(item); }
            } else { window.history.replaceState({}, "", `/${slug}`); renderSeriesLanding(item); }
        } else {
            if (subPage === 'watch') renderPlayer(item, 0);
            else renderSeriesLanding(item); 
        }
    }

    const getSkeleton = () => `<div class="px-4 lg:px-8 py-8 max-w-[1600px] mx-auto"><div class="w-full h-[40vh] md:h-[50vh] bg-[#141414] rounded-2xl animate-pulse mb-10"></div><div class="grid grid-cols-2 md:grid-cols-3 gap-4">${Array(6).fill(0).map(() => `<div class="aspect-video bg-[#141414] rounded-xl animate-pulse"></div>`).join('')}</div></div>`;

    async function init() {
        document.getElementById('app').innerHTML = getSkeleton();
        try {
            const res = await fetch('data/normal.json');
            if(!res.ok) throw new Error("JSON Not Found");
            const json = await res.json();
            
            allContent = json.map(item => ({
                ...item,
                name: item.title,
                imageUrl: item.thumbnail,
                id: createSlug(item.title)
            })).reverse();
            
            handleLocation();
        } catch(e) { 
            document.getElementById('app').innerHTML = `<div class="h-screen flex justify-center items-center text-red-500">Error: data/normal.json not found</div>`;
        }
    }

    function render404() {
        updateSEO({ title: "Page Not Found", desc: "Content does not exist.", robots: "noindex" });
        document.getElementById('app').innerHTML = `<div class="min-h-screen flex flex-col items-center justify-center text-center px-4"><h1 class="text-6xl font-bold text-brand mb-4">404</h1><p class="text-xl text-gray-300 mb-8">Content not found.</p><a href="/" onclick="route(event)" class="bg-white text-black px-6 py-3 rounded-lg font-bold">Go Home</a></div>${getFooter()}`;
    }

    // --- HOME PAGE ---
    function renderHome(filterType = null) {
        updateSEO({ title: "Ranginx - Watch Latest Web Series & Movies", desc: "Premium streaming destination.", robots: "index, follow" });

        const data = filterType ? allContent.filter(i => i.type === filterType) : allContent;
        const featured = data.find(i => i.isFeatured) || data[0];
        
        let html = `
        <div id="header-ad" class="ad-slot">${ADS.header}</div>
        <div class="px-4 md:px-8 py-6 max-w-[1600px] mx-auto min-h-screen">
            <div class="flex gap-3 overflow-x-auto pb-6 sticky top-16 bg-[#0a0a0a] z-20 py-2 no-scrollbar">
                <a href="/" onclick="route(event)" class="${!filterType?'bg-white text-black':'bg-[#141414] text-gray-400 hover:text-white border border-[#262626]'} px-6 py-2 rounded-full text-sm font-bold whitespace-nowrap transition shadow-lg">All</a>
                <a href="/series" onclick="route(event)" class="${filterType==='series'?'bg-white text-black':'bg-[#141414] text-gray-400 hover:text-white border border-[#262626]'} px-6 py-2 rounded-full text-sm font-bold whitespace-nowrap transition shadow-lg">Series</a>
                <a href="/movies" onclick="route(event)" class="${filterType==='movie'?'bg-white text-black':'bg-[#141414] text-gray-400 hover:text-white border border-[#262626]'} px-6 py-2 rounded-full text-sm font-bold whitespace-nowrap transition shadow-lg">Movies</a>
            </div>

            ${featured && !filterType ? `
            <div class="relative w-full h-[50vh] md:h-[60vh] rounded-2xl overflow-hidden mb-12 group border border-[#262626]">
                <div class="absolute inset-0 bg-cover bg-center transition duration-700 group-hover:scale-105" style="background-image: url('${featured.imageUrl}');"></div>
                <div class="absolute inset-0 bg-gradient-to-r from-black via-black/80 to-transparent"></div>
                <div class="absolute bottom-0 left-0 p-6 md:p-12 w-full md:w-2/3">
                    <span class="bg-brand text-white text-[10px] font-bold px-2 py-1 rounded uppercase tracking-wider mb-3 inline-block shadow-lg">Featured</span>
                    <h1 class="text-3xl md:text-5xl font-bold text-white mb-4 leading-tight drop-shadow-lg">${featured.name}</h1>
                    <p class="text-gray-300 text-sm md:text-base line-clamp-2 mb-6 max-w-lg">${getStoryline(featured)}</p>
                    <a href="/${createSlug(featured.name)}" onclick="route(event)" class="inline-flex items-center gap-2 bg-white text-black px-6 py-3 rounded-lg font-bold hover:bg-gray-200 transition"><i data-lucide="play" class="w-5 h-5 fill-black"></i> Watch Now</a>
                </div>
            </div>` : ''}
            
            <div class="animate-fade">`;

        // Logic to Separate Movies and Series on Home
        if (!filterType) {
            const series = allContent.filter(i => i.type === 'series');
            const movies = allContent.filter(i => i.type === 'movie');

            if(series.length > 0) {
                html += `<h2 class="text-xl font-bold text-white mb-6 border-l-4 border-brand pl-3">Latest Web Series</h2>`;
                html += `<div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 gap-y-8 mb-12">`;
                html += generateGridItemsWithAds(series);
                html += `</div>`;
            }

            if(movies.length > 0) {
                html += `<h2 class="text-xl font-bold text-white mb-6 border-l-4 border-brand pl-3">Latest Movies</h2>`;
                html += `<div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 gap-y-8">`;
                html += generateGridItemsWithAds(movies);
                html += `</div>`;
            }
        } else {
            // Filtered View
            html += `<div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 gap-y-8">`;
            html += generateGridItemsWithAds(data);
            html += `</div>`;
        }

        html += `</div></div>${getFooter()}`;
        document.getElementById('app').innerHTML = html;
        renderAd('header-ad', ADS.header);
        renderAd('footer-ad', ADS.footer);
        lucide.createIcons();
    }

    // --- DETAIL PAGE ---
    function renderSeriesLanding(item) {
        const isSeries = item.type === 'series';
        updateSEO({ title: `${item.name} - Watch Free`, desc: getStoryline(item), image: item.imageUrl });
        const actionBtn = isSeries 
            ? `<a href="/${item.slug}/episode-1" onclick="route(event)" class="bg-brand hover:bg-red-700 text-white px-8 py-3.5 rounded-lg font-bold flex items-center gap-2 transition transform hover:scale-105"><i data-lucide="play-circle" class="w-5 h-5"></i> Start Watching Episode 1</a>`
            : `<a href="/${item.slug}/watch" onclick="route(event)" class="bg-brand hover:bg-red-700 text-white px-8 py-3.5 rounded-lg font-bold flex items-center gap-2 transition transform hover:scale-105"><i data-lucide="play" class="w-5 h-5"></i> Play Movie</a>`;

        let html = `
        <div class="min-h-screen">
            <div class="relative w-full h-[60vh] lg:h-[70vh]">
                <div class="absolute inset-0 bg-cover bg-top" style="background-image: url('${item.imageUrl}');"></div>
                <div class="absolute inset-0 bg-gradient-to-t from-[#0a0a0a] via-[#0a0a0a]/80 to-transparent"></div>
                <div class="absolute inset-0 bg-gradient-to-r from-[#0a0a0a] via-[#0a0a0a]/60 to-transparent"></div>
                <div class="absolute bottom-0 left-0 w-full p-6 lg:p-12 flex flex-col md:flex-row gap-8 items-end max-w-[1600px] mx-auto">
                    <div class="hidden md:block w-48 lg:w-64 flex-shrink-0 rounded-lg overflow-hidden shadow-2xl border border-[#262626]"><img src="${item.imageUrl}" class="w-full h-full object-cover"></div>
                    <div class="mb-4">
                        <span class="bg-brand text-white text-xs font-bold px-2 py-1 rounded uppercase mb-3 inline-block">${isSeries ? 'Web Series' : 'Movie'}</span>
                        <h1 class="text-3xl md:text-5xl lg:text-6xl font-bold text-white mb-4 leading-tight">${item.name}</h1>
                        <p class="text-gray-300 text-sm md:text-lg max-w-2xl line-clamp-3 mb-6">${getStoryline(item)}</p>
                        <div class="flex flex-wrap gap-4">${actionBtn}</div>
                    </div>
                </div>
            </div>
            <div id="detail-ad-top" class="ad-slot">${ADS.playerTop}</div>
            <div class="max-w-[1600px] mx-auto px-6 py-12">
                ${isSeries && item.episodes ? `
                <div class="flex items-center justify-between mb-8 border-b border-[#262626] pb-4"><h2 class="text-2xl font-bold text-white flex items-center gap-2"><i data-lucide="layers" class="text-brand"></i> All Episodes <span class="text-gray-500 text-lg font-normal">(${item.episodes.length})</span></h2></div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-12">
                    ${item.episodes.map((ep, index) => `
                        <a href="/${item.slug}/episode-${index+1}" onclick="route(event)" class="group bg-[#141414] border border-[#262626] hover:border-brand rounded-xl overflow-hidden transition hover:shadow-lg flex md:block">
                            <div class="w-32 md:w-full md:aspect-video relative overflow-hidden bg-black flex-shrink-0"><img src="${item.imageUrl}" class="w-full h-full object-cover opacity-60 group-hover:opacity-100 transition duration-500"><div class="absolute inset-0 flex items-center justify-center"><div class="bg-white/10 backdrop-blur-sm p-2 rounded-full group-hover:bg-brand group-hover:text-white transition"><i data-lucide="play" class="w-5 h-5 fill-current"></i></div></div></div>
                            <div class="p-4 flex flex-col justify-center">
                                <h3 class="font-bold text-white group-hover:text-brand transition text-lg">Episode ${index + 1}</h3>
                                ${ep.title ? `<p class="text-gray-400 text-xs mt-1 font-medium">${ep.title}</p>` : ''}
                            </div>
                        </a>`).join('')}
                </div>` : ''}
                
                <section class="seo-content-wrapper">
                    <article id="seo-content">
                        <h2>About ${item.name}</h2>
                        <p>${getStoryline(item)}</p>
                    </article>
                </section>
            </div>${getFooter()}`;
        document.getElementById('app').innerHTML = html;
        renderAd('detail-ad-top', ADS.playerTop);
        lucide.createIcons();
    }

    // --- PLAYER PAGE ---
    function renderPlayer(item, epNum) {
        const isSeries = item.type === 'series';
        let videoSrc = "", pageTitle = item.name;
        
        if(isSeries) {
            const ep = item.episodes[epNum-1]; 
            if(!ep) return render404();
            videoSrc = ep.url;
            pageTitle = `${item.name} - Episode ${epNum}`;
        } else {
            videoSrc = item.video || ""; 
        }

        updateSEO({ title: pageTitle, desc: getStoryline(item), image: item.imageUrl });

        // Recommendations (Same Type)
        const recs = allContent.filter(i => i.type === item.type && i.id !== item.id).slice(0, 10);

        let html = `
        <div class="max-w-[1800px] mx-auto lg:px-6 py-6 animate-fade">
            <div class="px-4 lg:px-0 text-sm text-gray-400 mb-4 flex items-center gap-2"><a href="/" onclick="route(event)" class="hover:text-white">Home</a> / <a href="/${item.slug}" onclick="route(event)" class="hover:text-white">${item.name}</a> / <span class="text-brand">Watch</span></div>
            <div class="flex flex-col lg:flex-row gap-8">
                <div class="w-full lg:w-[75%]">
                    <div id="player-ad-top" class="ad-slot">${ADS.playerTop}</div>
                    
                    <div class="relative bg-black rounded-xl overflow-hidden shadow-2xl border border-[#262626]">
                        <div class="aspect-video w-full relative z-10" id="player-wrapper"></div>
                    </div>
                    
                    <div id="player-ad-bot" class="ad-slot">${ADS.playerBottom}</div>

                    <div class="mt-6 px-4 lg:px-0">
                        <div class="flex justify-between items-start mb-4">
                            <h1 class="text-2xl md:text-3xl font-bold text-white leading-tight">${pageTitle}</h1>
                        </div>
                        
                        <div class="mb-8 p-5 bg-[#111] rounded-xl border border-[#262626]">
                            <h2 class="text-white font-semibold mb-3 text-lg flex items-center gap-2"><i data-lucide="book-open" class="w-5 h-5 text-brand"></i> Storyline</h2>
                            <p class="text-gray-300 text-sm leading-7">${getStoryline(item)}</p>
                        </div>

                        ${isSeries ? `<div class="mt-8 bg-[#141414] border border-[#262626] rounded-xl p-6"><div class="flex justify-between items-center mb-4"><h3 class="text-white font-semibold flex items-center gap-2"><i data-lucide="layers" class="w-5 h-5 text-brand"></i> Episodes</h3></div><div class="grid grid-cols-5 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 gap-2">${item.episodes.map((ep, idx) => `<a href="/${item.slug}/episode-${idx+1}" onclick="route(event)" class="ep-btn ${idx+1 === epNum ? 'active' : ''}">${idx + 1}</a>`).join('')}</div></div>` : ''}
                    </div>
                </div>
                
                <div class="w-full lg:w-[25%] px-4 lg:px-0">
                    <h3 class="font-bold text-white text-lg mb-4 pl-2 border-l-4 border-brand">You may also like</h3>
                    <div class="flex flex-col gap-4">
                        ${recs.map(s => `
                        <a href="/${s.slug}" onclick="route(event)" class="flex gap-3 group bg-[#141414] hover:bg-[#1a1a1a] p-2 rounded-lg transition border border-transparent hover:border-[#333]">
                            <div class="w-28 aspect-video bg-[#222] rounded overflow-hidden flex-shrink-0 relative">
                                <img src="${s.imageUrl}" class="w-full h-full object-cover group-hover:scale-105 transition" loading="lazy">
                            </div>
                            <div class="py-1 min-w-0 flex flex-col justify-center">
                                <h4 class="text-sm font-semibold text-gray-200 line-clamp-2 group-hover:text-brand transition leading-snug">${s.name}</h4>
                                <span class="text-[10px] text-gray-500 mt-1">${s.type === 'series' ? 'Series' : 'Movie'}</span>
                            </div>
                        </a>`).join('')}
                    </div>
                </div>
            </div>
        </div>${getFooter()}`;

        document.getElementById('app').innerHTML = html;
        renderAd('player-ad-top', ADS.playerTop);
        renderAd('player-ad-bot', ADS.playerBottom);
        lucide.createIcons();
        initNativePlayer(videoSrc, item.imageUrl);
    }

    // --- PLAYER LOGIC (Fast Native) ---
    function destroyPlayer() {
        const wrapper = document.getElementById('player-wrapper');
        if(wrapper) wrapper.innerHTML = '';
        if(STATE.hls) { STATE.hls.destroy(); STATE.hls = null; }
    }

    function initNativePlayer(src, poster) {
        const wrapper = document.getElementById('player-wrapper');
        wrapper.innerHTML = ''; 

        if (!src.includes('.mp4') && !src.includes('.m3u8')) {
            wrapper.innerHTML = `<iframe src="${src}" class="w-full h-full border-0" allowfullscreen></iframe>`;
            return;
        }

        const video = document.createElement('video');
        video.className = "w-full h-full bg-black";
        video.controls = true;
        video.poster = poster || '';
        video.setAttribute('playsinline', '');
        video.autoplay = true;
        
        wrapper.appendChild(video);

        if (Hls.isSupported() && src.includes('.m3u8')) {
            const hls = new Hls();
            hls.loadSource(src);
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED, () => {
                video.play().catch(()=>{});
            });
            STATE.hls = hls;
        } else {
            video.src = src;
            video.play().catch(()=>{});
        }
    }

    function generateGridItemsWithAds(items) {
        let html = '';
        let count = 0;
        items.forEach((item, index) => {
            html += `
            <a href="/${createSlug(item.name)}" onclick="route(event)" class="group block relative">
                <div class="relative aspect-video rounded-xl overflow-hidden mb-3 shadow-lg bg-[#141414] border border-[#222]">
                    <img src="${item.imageUrl}" class="w-full h-full object-cover group-hover:scale-110 transition duration-500" loading="lazy">
                    <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition duration-300 flex items-center justify-center backdrop-blur-[2px]">
                         <div class="bg-brand/90 p-3 rounded-full shadow-xl transform scale-50 group-hover:scale-100 transition duration-300"><i data-lucide="play" class="w-6 h-6 fill-white text-white"></i></div>
                    </div>
                    <div class="absolute top-2 right-2 bg-black/60 backdrop-blur-md text-white text-[10px] font-bold px-2 py-1 rounded border border-white/10 uppercase">${item.type==='series'?'TV':'MOV'}</div>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-gray-200 line-clamp-1 group-hover:text-brand transition">${item.name}</h3>
                    <div class="flex items-center justify-between mt-1"><span class="text-[11px] text-gray-500">2025</span><span class="text-[10px] border border-gray-700 text-gray-400 px-1 rounded">HD</span></div>
                </div>
            </a>`;
            count++;
            if (count % 5 === 0 && ADS.grid) html += `<div class="col-span-2 md:col-span-3 lg:col-span-4 ad-slot active">${ADS.grid}</div>`;
        });
        return html;
    }

    function createSlug(name) { return name.toLowerCase().trim().replace(/[^a-z0-9]+/g, '-'); }
    function renderAd(id, code) { const el = document.getElementById(id); if(el && code) { el.innerHTML = code; el.classList.add('active'); } }

    function getFooter() {
        return `
        <div id="footer-ad" class="ad-slot">${ADS.footer}</div>
        <footer class="bg-[#050505] border-t border-[#1a1a1a] pt-16 pb-10 mt-12">
            <div class="max-w-[1400px] mx-auto px-6 grid grid-cols-2 md:grid-cols-4 gap-10">
                <div class="col-span-2 md:col-span-1"><h3 class="text-white font-bold text-xl mb-4 tracking-tight">Ranginx</h3><p class="text-gray-500 text-sm leading-relaxed">The best place to watch movies and web series for free in HD quality. No registration required.</p></div>
                <div><h4 class="text-white font-semibold text-sm mb-4 uppercase tracking-wider">Browse</h4><a href="/movies" onclick="route(event)" class="footer-link">Movies</a><a href="/series" onclick="route(event)" class="footer-link">Web Series</a></div>
                <div><h4 class="text-white font-semibold text-sm mb-4 uppercase tracking-wider">Support</h4><button onclick="openModal('dmca')" class="footer-link text-left w-full">DMCA</button><button onclick="openModal('privacy')" class="footer-link text-left w-full">Privacy Policy</button><button onclick="openModal('terms')" class="footer-link text-left w-full">Terms</button></div>
            </div>
            <div class="text-center pt-8 border-t border-[#1a1a1a] mt-10 text-[11px] text-[#444]">&copy; 2025 Ranginx. All rights reserved.</div>
        </footer>`;
    }
    
    // --- COMPLETE LEGAL TEXT ---
    const LEGAL_TEXT = {
        dmca: `
            <h2>DMCA Copyright Infringement Notification</h2>
            <p>Ranginx respects the intellectual property rights of others. Ranginx operates as a search engine and does not host, upload, or store any video files on its servers. All content is provided by non-affiliated third parties.</p>
            <p>If you believe that your copyrighted work has been copied in a way that constitutes copyright infringement and is accessible on this site, please notify our copyright agent. We will remove the content immediately upon verification.</p>
        `,
        privacy: `
            <h2>Privacy Policy</h2>
            <p>At Ranginx, accessible from ranginx.fun, one of our main priorities is the privacy of our visitors. This Privacy Policy document contains types of information that is collected and recorded by Ranginx and how we use it.</p>
            <h3>Log Files</h3>
            <p>Ranginx follows a standard procedure of using log files. These files log visitors when they visit websites. The information collected by log files includes internet protocol (IP) addresses, browser type, Internet Service Provider (ISP), date and time stamp.</p>
            <h3>Cookies</h3>
            <p>Like any other website, Ranginx uses 'cookies'. These cookies are used to store information including visitors' preferences, and the pages on the website that the visitor accessed or visited.</p>
        `,
        terms: `
            <h2>Terms and Conditions</h2>
            <p>Welcome to Ranginx! These terms and conditions outline the rules and regulations for the use of Ranginx's Website.</p>
            <h3>License</h3>
            <p>Unless otherwise stated, Ranginx and/or its licensors own the intellectual property rights for all material on Ranginx. All intellectual property rights are reserved.</p>
            <h3>Disclaimer</h3>
            <p>To the maximum extent permitted by applicable law, we exclude all representations, warranties and conditions relating to our website and the use of this website.</p>
        `
    };

    window.toggleSidebar = () => { document.getElementById('sidebar').classList.toggle('-translate-x-full'); document.getElementById('overlay').classList.toggle('hidden'); };
    document.getElementById('menu-btn').onclick = toggleSidebar;
    
    window.handleSearch = (val) => {
        if(!val) { renderHome(); return; }
        const v = val.toLowerCase();
        const filtered = allContent.filter(i => i.name.toLowerCase().includes(v));
        let html = `<div class="px-4 py-8 max-w-[1600px] mx-auto"><h2 class="text-xl font-bold text-white mb-6">Search Results</h2><div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">`;
        html += generateGridItemsWithAds(filtered);
        html += `</div></div>${getFooter()}`;
        document.getElementById('app').innerHTML = html;
        document.getElementById('mobile-search').classList.add('hidden');
    };
    document.getElementById('desktop-search').addEventListener('keyup', (e) => { if (e.key === 'Enter') handleSearch(e.target.value) });

    window.openModal = (t) => { document.getElementById('legal-modal').classList.remove('hidden'); document.getElementById('legal-modal').classList.add('flex'); document.getElementById('modal-body').innerHTML = LEGAL_TEXT[t]; };
    window.closeModal = () => { document.getElementById('legal-modal').classList.add('hidden'); document.getElementById('legal-modal').classList.remove('flex'); };

    init();
</script>
</body>
</html>
